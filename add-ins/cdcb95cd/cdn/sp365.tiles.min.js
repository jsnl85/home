"use strict";(function(e){var n=e.WebParts=e.WebParts||{};n.SmartTilesWebPart=e.WebParts.SmartTilesWebPart=function(n,a){var r=this;r.base=n;for(var t in r.base||{})r[t]=r.base[t];var i=a,d=null,s=null,o=function(){return i&&i.data&&Array.isArray(i.data)?newResolvedPromise(i.data):newResolvedPromise([])},l=function(){r.base.destroyRenderContainer();var e=r.base.getRenderContainer();e.append(d("<div>").addClass("row-fluid").append(d("<div>").addClass("col-md-12").append(d("<div>").addClass("loading description").html("Loading Tiles..."))))},u=function(e){r.base.destroyRenderContainer();var n=r.base.getRenderContainer();n.append(d("<div>").addClass("row-fluid").append(d("<div>").addClass("col-md-12").append((e|[]).map(function(e){return d("<a>").prop("href",e.url).append(d("<div>").addClass("tile").append(d("<div>").addClass("title").html(e.title)))}))))};r.init=function(n){var a=newPromise(function(n,a){e.logVerbose("- initialising SmartTilesWebPart on '"+i+"'."),e.allPromise([e.requireJQuery(),e.requireAngular()]).then(function(r){d=r[0],s=r[1],l(),o().then(function(e){try{u(e)}catch(e){a(e.message)}},function(e){logError("- Could not load the Tiles data."),a(ex.message)}),e.log("- inited a new instance of SmartTilesWebPart on '"+i+"'."),n()},a)});return a},r.destroy=function(){return newPromise(function(e,n){r.super.destroy().then(function(){destroyRenderContainer(),e(r)},n)})}}})(window.SP365=window.SP365||{});