"use strict";(function(_m){function SimplePromise(e){var r=this,n=[],t=function(e,t,i,o,s){r.then="resolve"===e?function(e,r){e&&e(t,i,o,s)}:function(e,r){r&&r(t,i,o,s)},r.resolve=r.reject=function(){throw new Error("Promise already completed.")};for(var c,u=0;c=n[u++];)c[e]&&c[e](t,i,o,s);n=[]};r.then=function(e,r){n.push({resolve:e,reject:r})},r.resolve=function(e,r,n,i){t("resolve",e,r,n,i)},r.reject=function(e,r,n,i){t("reject",e,r,n,i)},"function"==typeof e&&setTimeout(function(){e(r.resolve,r.reject)},0)}var baseScriptFolderPath="https://sp365.pro/add-ins/cdcb95cd/cdn/",baseScriptPath=baseScriptFolderPath+"sp365.min.js",scriptVersion="1.0.0.0",log=_m.log=function(e){window.console&&window.console.log&&window.console.log(e)},logWarning=_m.logWarning=log,logError=_m.logError=log,logVerbose=_m.logVerbose=function(e){/log|debug|verbose/gi.test(""+window.location)&&log(e)},config=_m.config=_m.config||{},version=config.version=config.version||scriptVersion,isDebugQ=function(){return!!/debug/gi.test(""+window.location)};isDebugQ()&&(logVerbose=_m.logVerbose=log);var newResolvedPromise=_m.newResolvedPromise=function(e){return newPromise(function(r,n){r(e)})},newRejectedPromise=_m.newRejectedPromise=function(e){return newPromise(function(r,n){n(e)})},newPromise=_m.newPromise=function(e){var r=null;return r="function"==typeof Promise?new Promise(e):new SimplePromise(e)},allPromise=_m.allPromise=function(e,r){var n=(r||{}).alwaysResolveQ,t=function(e){return e&&"function"==typeof e.then};if(void 0===n&&"function"==typeof Promise)return Promise.all(e);if(e&&e.length>0){var i=newPromise(function(r,i){for(var o=0+e.length,s=[],c=[],u=function(){for(var e=0;e<o;e++)if(c[e]!==!0)return!1;return!0},a=0;a<e.length;a++){var l=e[a];t(l)?function(e){l.then(function(n){logVerbose("- resolved during an allPromise(promises) call."),s[e]=n,c[e]=!0,u()&&r(s)},function(t){logVerbose("- rejection during an allPromise(promises) call."),1==n?(s[e]=t,c[e]=!0,u()&&r(s)):i(t)})}(a):(s[refI]=l,c[refI]=!0,resovleAllIfComplete())}});return i}return newResolvedPromise()},_requireCache=[],require=_m.require=function(scriptId,scriptSrc,asyncQ){var promise=newPromise(function(resolve,reject){if(scriptSrc=void 0!==scriptSrc?scriptSrc:scriptId,scriptId=(/([^\/\\?]+)(\?|$)/gi.exec(scriptId)[1]||scriptId).replace(/(\.min)?(\.js)?/gi,"").replace(/[^a-z0-9]/gi,"_").toLowerCase(),!scriptId)return void reject("Please provide a valid 'scriptId'.");void 0===asyncQ&&(asyncQ=!0);var isCSS=!!/[.]css[^\/]*$/gi.test(scriptSrc),elId=isCSS?"CSS_"+scriptId:"JS_"+scriptId,c=_requireCache.filter(function(e){return e&&e.id==scriptId})[0],isNewQ=!c;if(isNewQ){if(!scriptSrc)return void reject("Cannot complete require for scriptId '"+scriptId+"' because no 'scriptSrc' was provided.");c={id:scriptId,src:scriptSrc,module:void 0},_requireCache.push(c)}var handleErrors=function(e){logError("Could not load scriptId '"+scriptId+"' from scriptSrc '"+scriptSrc+"'. Error: "+(e||{}).statusText||(e||{}).message||""),reject(null)},handleLoad=function(r){var script=r.responseText||"";logVerbose("- retrieved scriptId '"+scriptId+"' from '"+scriptSrc+"' with length '"+script.length+"'.");var m=function(s){var module={exports:{}},customDefineQ=!1;window.define||(window.define=function(){var e=arguments[0];e="string"==typeof e?[e]:e||[];var r=function(){};arguments.length>1&&arguments[arguments.length-1];var n=(e||[]).map(require);allPromise(n).then(function(e){r.apply(null,e)},reject)},window.define.amd=!0,customDefineQ=!0);try{eval("(function(module,exports){ "+s+" })(module,module.exports);")}catch(ex){eval(s)}return 1==customDefineQ&&delete window.define,module}(script),c=_requireCache.filter(function(e){return e&&e.id==scriptId})[0];c.module=m,resolve(m.exports)};try{if(isCSS){if(document.getElementById(elId))logVerbose("- already included CSS '"+scriptId+"' from '"+scriptSrc+"'");else{var head=document.getElementsByTagName("head")[0],link=document.createElement("link");link.id=elId,link.rel="stylesheet",link.type="text/css",link.href=scriptSrc,head.appendChild(link)}resolve()}else if(isNewQ){var r=(XMLHttpRequest,new XMLHttpRequest);r.open("GET",scriptSrc,asyncQ),r.onload=function(e){4===r.readyState&&(200===r.status?handleLoad(r):handleErrors(r))},r.onerror=function(e){handleErrors(r)},r.send(null)}else{var waitUntilModuleLoaded=c&&c.module?newResolvedPromise(c.module):newPromise(function(e,r){logVerbose("- waiting until scriptId '"+scriptId+"' is loaded."),function(){var n=0,t=null,i=function(){var o=_requireCache.filter(function(e){return e&&e.id==scriptId})[0];o&&o.module?e(o.module):n++<30?(logVerbose("- waiting for scriptId '"+scriptId+"'."),t=window.setTimeout(i,100)):r("Waited for too long for scriptId '"+scriptId+"'.")};t=window.setTimeout(i,100)}()});waitUntilModuleLoaded.then(function(e){logVerbose("- already included '"+scriptId+"'."),resolve(e.exports)},reject)}}catch(e){handleErrors(e)}});return promise},requireJQuery=_m.requireJQuery=function(){return"undefined"!=typeof jQuery?newResolvedPromise(jQuery):require("jquery","//code.jquery.com/jquery.min.js",!0)},requireJQueryUI=_m.requireJQueryUI=function(){return"undefined"!=typeof jQuery&&jQuery.ui?newResolvedPromise(jQuery.ui):allPromise([require("jquery-ui.css","//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.min.css",!0),newPromise(function(e,r){requireJQuery().then(function(n){require("jquery-ui","//code.jquery.com/ui/1.12.1/jquery-ui.min.js",!0).then(e,r)})})])},requireAngular=_m.requireAngular=function(){return"undefined"!=typeof angular&&angular?newResolvedPromise(angular):require("angular","//ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js",!0)},requireSPJS=_m.requireSPJS=function(){return"undefined"!=typeof SP?newResolvedPromise(SP):require("sp.js",getPageInfo(!1).webAbsoluteUrl+"/_layouts/15/sp.js",!0)},requireSPRequestExecutor=_m.requireSPRequestExecutor=function(){return"undefined"!=typeof SP&&SP.RequestExecutor?newResolvedPromise(SP.RequestExecutor):require("sp.requestexecutor",getPageInfo(!1).webAbsoluteUrl+"/_layouts/15/SP.RequestExecutor.js",!0)},requireSPClientContext=_m.requireSPClientContext=function(){return newPromise(function(e,r){requireSPJS().then(function(){"undefined"!=typeof SP&&SP.SOD?SP.SOD.executeFunc("sp.js","SP.ClientContext",function(){e()}):r()},r)})},newId=_m.newId=function(e){var r="";for(e||(e=4);r.length<e;)r+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return r.length>e?r.substring(0,e):r},newGuid=_m.newGuid=function(){return newId(8)+"-"+newId(4)+"-"+newId(4)+"-"+newId(4)+"-"+newId(12)},newElementId=_m.newElementId=function(){return newId(8)+"_"+newId(4)+"_"+newId(4)+"_"+newId(4)+"_"+newId(12)},tryParseJson=_m.tryParseJson=function(e){var r;try{r=JSON.parse(e)}catch(r){logVerbose("- could not parse JSON '"+e+"'. Error: "+r.message)}return r},trySerialiseJson=_m.tryParseJson=function(e){var r;try{r=JSON.stringify(e)}catch(r){logVerbose("- could not serialise object to JSON '"+e+"'. Error: "+r.message)}return r},WebParts=_m.WebParts=_m.WebParts||{};WebParts.BaseWebPart=_m.WebParts.BaseWebPart=function(e){var r=this,n=null,t=e,i=r.getConfig=function(){return tryParseJson(t.attr("sp365-wp"))},o=r.setConfig=function(e){var r=trySerialiseJson(e);r?t.attr("sp365-wp",r):(logWarning("- Could not set the BaseWebPart config because wpConfig could not be serialised to JSON."),s()||logVerbose("- NOTE: a call to BaseWebpart.setConfig() was done, but content is not editable."))},s=r.isEditableQ=function(){return tryParseJson(t.closest("[contenteditable]").attr("contenteditable"))};r.init=function(){var e=newPromise(function(e,s){var c=i();if(c){if(logVerbose("- loaded custom webpart from '"+t+"' with config '"+c+"'."),!c.id){var u=t.closest("[webpartid]"),a=1==u.length&&1==u.find("sp365-wp").length?"wp_"+u.attr("webpartid"):"";a||(a="wp_"+newElementId()),c.id=a,o(c)}if(c.type){var l=[{regex:/^LinkedInConnector$/gi,scriptId:"sp365.linkedin",scriptSrc:baseScriptFolderPath+"sp365.linkedin.min.js?"+scriptVersion,createNew:function(){return new WebParts.LinkedInConnectorWebPart(r,t)}},{regex:/^SmartTiles$/gi,scriptId:"sp365.tiles",scriptSrc:baseScriptFolderPath+"sp365.tiles.min.js?"+scriptVersion,createNew:function(){return new WebParts.SmartTilesWebPart(r,t)}}],d=l.filter(function(e){return e&&e.regex&&e.regex.test(c.type)})[0];if(d)try{if("function"!=typeof d.createNew)throw"createNew is not a function.";require(d.scriptId,d.scriptSrc,!0).then(function(){n=d.createNew(),t.find(".sp365-wp-description").hide(),n.init().then(e,s)},s)}catch(e){s("- error creating new instance of custom webpart from '"+t+"'. Error: "+e.message)}else s("- error loading custom webpart from '"+t+"' because 'type' was not recognised.")}else s("- error loading custom webpart from '"+t+"' because it did not define a 'type'.")}else s("- error loading custom webpart from '"+t+"' because config was empty.")});return e},r.destroy=function(){return newResolvedPromise(r)}};var initCustomWebParts=function(){requireJQuery().then(function(e){logVerbose("- loaded 'sp365.js' and dependencies.");var r=[];e("[sp365-wp]").each(function(){var n=new WebParts.BaseWebPart(e(this));r.push(n)}),allPromise(r.map(function(e){return e.init()}),{alwaysResolveQ:!0}).then(function(e){var r=e||[];logVerbose("- inited '"+r.length+"' webparts.")})},function(e){logError("- Could not initialise the SP365 Add-Ins. Error: "+e)})},init=function(){logVerbose("- loading 'sp365.js'."),requireJQuery().then(function(e){logVerbose("- loaded 'sp365.js' and dependencies."),initCustomWebParts()},function(e){logError("- Could not initialise the SP365 Add-Ins. Error: "+e)})};try{init()}catch(e){logError("Unexpected error initializing 'sp365.js'.")}})(window.SP365=window.SP365||{});