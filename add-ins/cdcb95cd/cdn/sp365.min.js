"use strict";(function(_m){function SimplePromise(e){var r=this,t=[],n=function(e,n,o,i,s){r.then="resolve"===e?function(e,r){e&&e(n,o,i,s)}:function(e,r){r&&r(n,o,i,s)},r.resolve=r.reject=function(){throw new Error("Promise already completed.")};for(var a,l=0;a=t[l++];)a[e]&&a[e](n,o,i,s);t=[]};r.then=function(e,r){t.push({resolve:e,reject:r})},r.resolve=function(e,r,t,o){n("resolve",e,r,t,o)},r.reject=function(e,r,t,o){n("reject",e,r,t,o)},"function"==typeof e&&setTimeout(function(){e(r.resolve,r.reject)},0)}var baseScriptFolderPath="https://sp365.pro/add-ins/cdcb95cd/cdn/",baseScriptPath=baseScriptFolderPath+"sp365.min.js",scriptVersion="1.0.0.0",log=_m.log=function(e){window.console&&window.console.log&&window.console.log(e)},logWarning=_m.logWarning=log,logError=_m.logError=log,logVerbose=_m.logVerbose=function(e){/log|debug|verbose/gi.test(""+window.location)&&log(e)},config=_m.config=_m.config||{},version=config.version=config.version||scriptVersion,isDebugQ=function(){return!!/debug/gi.test(""+window.location)};isDebugQ()&&(logVerbose=_m.logVerbose=log);var newResolvedPromise=_m.newResolvedPromise=function(e){return newPromise(function(r,t){r(e)})},newRejectedPromise=_m.newRejectedPromise=function(e){return newPromise(function(r,t){t(e)})},newPromise=_m.newPromise=function(e){var r=null;return r="function"==typeof Promise?new Promise(e):new SimplePromise(e)},allPromise=_m.allPromise=function(e,r){var t=(r||{}).alwaysResolveQ,n=function(e){return e&&"function"==typeof e.then};if(void 0===t&&"function"==typeof Promise)return Promise.all(e);if(e&&e.length>0){var o=newPromise(function(r,o){for(var i=0+e.length,s=[],a=[],l=function(){for(var e=0;e<i;e++)if(a[e]!==!0)return!1;return!0},c=0;c<e.length;c++){var d=e[c];n(d)?function(e){d.then(function(t){logVerbose("- resolved during an allPromise(promises) call."),s[e]=t,a[e]=!0,l()&&r(s)},function(n){logVerbose("- rejection during an allPromise(promises) call."),1==t?(s[e]=n,a[e]=!0,l()&&r(s)):o(n)})}(c):(s[refI]=d,a[refI]=!0,resovleAllIfComplete())}});return o}return newResolvedPromise()},_requireCache=[],require=_m.require=function(scriptId,scriptSrc,asyncQ){var promise=newPromise(function(resolve,reject){if(scriptSrc=void 0!==scriptSrc?scriptSrc:scriptId,scriptId=(/([^\/\\?]+)(\?|$)/gi.exec(scriptId)[1]||scriptId).replace(/(\.min)?(\.js)?/gi,"").replace(/[^a-z0-9]/gi,"_").toLowerCase(),!scriptId)return void reject("Please provide a valid 'scriptId'.");void 0===asyncQ&&(asyncQ=!0);var isCSS=!!/[.]css[^\/]*$/gi.test(scriptSrc),elId=isCSS?"CSS_"+scriptId:"JS_"+scriptId,c=_requireCache.filter(function(e){return e&&e.id==scriptId})[0],isNewQ=!c;if(isNewQ){if(!scriptSrc)return void reject("Cannot complete require for scriptId '"+scriptId+"' because no 'scriptSrc' was provided.");c={id:scriptId,src:scriptSrc,module:void 0},_requireCache.push(c)}var handleErrors=function(e){logError("Could not load scriptId '"+scriptId+"' from scriptSrc '"+scriptSrc+"'. Error: "+(e||{}).statusText||(e||{}).message||""),reject(null)},handleLoad=function(r){var script=r.responseText||"";logVerbose("- retrieved scriptId '"+scriptId+"' from '"+scriptSrc+"' with length '"+script.length+"'.");var m=function(s){var module={exports:{}},customDefineQ=!1;window.define||(window.define=function(){var e=arguments[0];e="string"==typeof e?[e]:e||[];var r=function(){};arguments.length>1&&arguments[arguments.length-1];var t=(e||[]).map(require);allPromise(t).then(function(e){r.apply(null,e)},reject)},window.define.amd=!0,customDefineQ=!0);try{eval("(function(module,exports){ "+s+" })(module,module.exports);")}catch(ex){eval(s)}return 1==customDefineQ&&delete window.define,module}(script),c=_requireCache.filter(function(e){return e&&e.id==scriptId})[0];c.module=m,resolve(m.exports)};try{if(isCSS){if(document.getElementById(elId))logVerbose("- already included CSS '"+scriptId+"' from '"+scriptSrc+"'");else{var head=document.getElementsByTagName("head")[0],link=document.createElement("link");link.id=elId,link.rel="stylesheet",link.type="text/css",link.href=scriptSrc,head.appendChild(link)}resolve()}else if(isNewQ){var r=(XMLHttpRequest,new XMLHttpRequest);r.open("GET",scriptSrc,asyncQ),r.onload=function(e){4===r.readyState&&(200===r.status?handleLoad(r):handleErrors(r))},r.onerror=function(e){handleErrors(r)},r.send(null)}else{var waitUntilModuleLoaded=c&&c.module?newResolvedPromise(c.module):newPromise(function(e,r){logVerbose("- waiting until scriptId '"+scriptId+"' is loaded."),function(){var t=0,n=null,o=function(){var i=_requireCache.filter(function(e){return e&&e.id==scriptId})[0];i&&i.module?e(i.module):t++<30?(logVerbose("- waiting for scriptId '"+scriptId+"'."),n=window.setTimeout(o,100)):r("Waited for too long for scriptId '"+scriptId+"'.")};n=window.setTimeout(o,100)}()});waitUntilModuleLoaded.then(function(e){logVerbose("- already included '"+scriptId+"'."),resolve(e.exports)},reject)}}catch(e){handleErrors(e)}});return promise},requireJQuery=_m.requireJQuery=function(){return"undefined"!=typeof jQuery?newResolvedPromise(jQuery):require("jquery","//code.jquery.com/jquery.min.js",!0)},requireJQueryUI=_m.requireJQueryUI=function(){return"undefined"!=typeof jQuery&&jQuery.ui?newResolvedPromise(jQuery.ui):allPromise([require("jquery-ui.css","//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.min.css",!0),newPromise(function(e,r){requireJQuery().then(function(t){require("jquery-ui","//code.jquery.com/ui/1.12.1/jquery-ui.min.js",!0).then(e,r)})})])},requireAngular=_m.requireAngular=function(){return"undefined"!=typeof angular&&angular?newResolvedPromise(angular):require("angular","//ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js",!0)},requireSPJS=_m.requireSPJS=function(){return"undefined"!=typeof SP?newResolvedPromise(SP):require("sp.js",getPageInfo(!1).webAbsoluteUrl+"/_layouts/15/sp.js",!0)},requireSPRequestExecutor=_m.requireSPRequestExecutor=function(){return"undefined"!=typeof SP&&SP.RequestExecutor?newResolvedPromise(SP.RequestExecutor):require("sp.requestexecutor",getPageInfo(!1).webAbsoluteUrl+"/_layouts/15/SP.RequestExecutor.js",!0)},requireSPClientContext=_m.requireSPClientContext=function(){return newPromise(function(e,r){requireSPJS().then(function(){"undefined"!=typeof SP&&SP.SOD?SP.SOD.executeFunc("sp.js","SP.ClientContext",function(){e()}):r()},r)})},newId=_m.newId=function(e){var r="";for(e||(e=4);r.length<e;)r+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return r.length>e?r.substring(0,e):r},newGuid=_m.newGuid=function(){return newId(8)+"-"+newId(4)+"-"+newId(4)+"-"+newId(4)+"-"+newId(12)},newElementId=_m.newElementId=function(){return newId(8)+"_"+newId(4)+"_"+newId(4)+"_"+newId(4)+"_"+newId(12)},getIncludedStyle=_m.getIncludedStyle=function(e){for(var r=null,t=document.getElementsByTagName("style"),n=0;n<t.length;n++){var o=t[n];if(o.id==e){r=o;break}}return r},includeStyle=_m.includeStyle=function(e,r){if(e&&r)try{var t=getIncludedStyle(e);if(t)t.styleSheet?t.styleSheet.cssText=r:(t.firstChild&&t.removeChild(t.firstChild),t.appendChild(document.createTextNode(r))),logVerbose("includeStyle() - Already referenced Style '"+e+"'");else{t=document.createElement("style"),t.id=e,t.type="text/css",t.styleSheet?t.styleSheet.cssText=r:t.appendChild(document.createTextNode(r));var n=document.getElementsByTagName("head")[0];logVerbose("includeStyle() - Loaded Style '"+e+"'"),n.appendChild(t)}}catch(e){logError("includeStyle() - Unexpected error: "+e,"Error")}},removeStyle=_m.removeStyle=function(e){if(e){var r=getIncludedStyle(e);r&&r.parentNode.removeChild(r)}},showProgress=_m.showProgress=function(e,r,t,n){ensureJQuery(function(){e=e||$("body"),r=!(void 0!=r&&!r);var o=parseInteger(e.attr("showProgressCount")||"0");if(r){if(e.attr("showProgressCount",""+(o+1)),o>0)return;var i=e.find(".loading,.loading-progress");i.length>0?i.show():(t||(t="rgb(51,51,51)"),void 0==n&&(n="Loading..."),includeStyle("loading-progress-style",".loading-progress{display:flex;align-items:center;position:fixed;top:0px;left:0px;z-index:100;width:100%;height:100%;background-color:#fff;filter:alpha(opacity=30);opacity:.3;}.loader,.loader:before,.loader:after{background:"+t+";-webkit-animation:load1 1s infinite ease-in-out;animation:load1 1s infinite ease-in-out;width:1em;height:4em;}.loader{color:"+t+";text-indent:-9999em;margin:auto;font-size:11px;-webkit-transform:translateZ(0);-ms-transform:translateZ(0);transform:translateZ(0);-webkit-animation-delay:-0.16s;animation-delay:-0.16s;}.loader:before,.loader:after{position:absolute;top:0;content:'';}.loader:before{left:-1.5em;-webkit-animation-delay:-0.32s;animation-delay:-0.32s;}.loader:after{left:1.5em;}@-webkit-keyframes load1{ 0%,80%,100%{box-shadow:0 0;height:4em;} 40%{box-shadow:0 -2em;height:5em;}}@keyframes load1{ 0%,80%,100%{box-shadow:0 0;height:4em;} 40%{box-shadow:0 -2em;height:5em;}}"),e.prepend('<div class="loading-progress"><div class="loader loading-label">'+n+"</div></div>"))}else{if(e.attr("showProgressCount",""+(o>0?o-1:0)),o>1)return;var i=e.find(".loading");i.length>0?i.hide():(i=e.find(".loading-progress"),i.detach())}})},hideProgress=_m.hideProgress=function(e){showProgress(e,!1)},tryParseJson=_m.tryParseJson=function(e){var r;try{r=JSON.parse(e)}catch(r){logVerbose("- could not parse JSON '"+e+"'. Error: "+r.message)}return r},trySerialiseJson=_m.tryParseJson=function(e){var r;try{r=JSON.stringify(e)}catch(r){logVerbose("- could not serialise object to JSON '"+e+"'. Error: "+r.message)}return r},WebParts=_m.WebParts=_m.WebParts||{};WebParts.BaseWebPart=_m.WebParts.BaseWebPart=function(e){var r=this,t=null,n=e,o=null,i=r.getConfig=function(){return tryParseJson(n.attr("sp365-wp"))},s=r.setConfig=function(e){var r=trySerialiseJson(e);r?n.attr("sp365-wp",r):(logWarning("- Could not set the BaseWebPart config because wpConfig could not be serialised to JSON."),l()||logVerbose("- NOTE: a call to BaseWebpart.setConfig() was done, but content is not editable."))},a=r.disableRTE=function(){n.closest(".ms-rtestate-field,.ms-rtestate-write,.ms-rtestate-notify").remove("ms-rtestate-write").addClass("ms-rtestate-read").addClass("ms-rtepaste-remove")},l=r.isEditableQ=function(){return tryParseJson(n.closest("[contenteditable]").attr("contenteditable"))};r.getRenderContainer=function(){var e=n.closest("[webpartid]").parent(),r=e.find(".sp365-wp-container");return 0==r.length&&(r=o("<div>").addClass("sp365-wp-container").addClass("container-fluid"),e.append(r)),r},r.destroyRenderContainer=function(){var e=n.closest("[webpartid]").parent(),r=e.find(".sp365-wp-container");r.detach()},r.init=function(){var e=newPromise(function(e,l){requireJQuery().then(function(c){o=c;var d=i();if(d){if(logVerbose("- loaded custom webpart from '"+n+"' with config '"+d+"'."),!d.id){var u=n.attr("id")||n.closest("[webpartid]"),f=1==u.length&&1==u.find("sp365-wp").length?"wp_"+u.attr("webpartid"):"";f||(f="wp_"+newElementId()),d.id=f,s(d)}if(n.attr("id",d.id),includeStyle("hideWp_"+d.id,"#"+d.id+"{display:none}"),a(),d.type){var m=[{regex:/^LinkedInConnector$/gi,scriptId:"sp365.linkedin",scriptSrc:baseScriptFolderPath+"sp365.linkedin.min.js?"+scriptVersion,createNew:function(){return new WebParts.LinkedInConnectorWebPart(r,n)}},{regex:/^SmartTiles$/gi,scriptId:"sp365.tiles",scriptSrc:baseScriptFolderPath+"sp365.tiles.min.js?"+scriptVersion,createNew:function(){return new WebParts.SmartTilesWebPart(r,n)}}],p=m.filter(function(e){return e&&e.regex&&e.regex.test(d.type)})[0];if(p)try{if("function"!=typeof p.createNew)throw"createNew is not a function.";require(p.scriptId,p.scriptSrc,!0).then(function(){t=p.createNew(),t.init().then(e,l)},l)}catch(e){l("- error creating new instance of custom webpart from '"+n+"'. Error: "+e.message)}else l("- error loading custom webpart from '"+n+"' because 'type' was not recognised.")}else l("- error loading custom webpart from '"+n+"' because it did not define a 'type'.")}else l("- error loading custom webpart from '"+n+"' because config was empty.")},l)});return e},r.destroy=function(){return newResolvedPromise(r)}};var initCustomWebParts=function(){requireJQuery().then(function(e){logVerbose("- loaded 'sp365.js' and dependencies.");var r=[];e("[sp365-wp]").each(function(){var t=new WebParts.BaseWebPart(e(this));r.push(t)}),allPromise(r.map(function(e){return e.init()}),{alwaysResolveQ:!0}).then(function(e){var r=e||[];logVerbose("- inited '"+r.length+"' webparts.")})},function(e){logError("- Could not initialise the SP365 Add-Ins. Error: "+e)})},init=function(){logVerbose("- loading 'sp365.js'."),requireJQuery().then(function(e){logVerbose("- loaded 'sp365.js' and dependencies."),initCustomWebParts()},function(e){logError("- Could not initialise the SP365 Add-Ins. Error: "+e)})};try{init()}catch(e){logError("Unexpected error initializing 'sp365.js'.")}})(window.SP365=window.SP365||{});